<html>
    <head>
        <script type="text/javascript" src="js/aajs.js"></script>
        <script type="text/javascript" src="testlib.js"></script>
        <style>
            p {
                line-spacing: 2px;
            }
        </style>
    </head>
    <body>
    </body>
</html>
<script type="text/javascript">
         
    (function () {
            
        var tests = [
        
        {
            name : "Topocentric Moon Data for 2000-05-17 00:00 UTC, lat. 50.8796, long. 4.7009, alt. 0",
            input : [AAJS.Date.DateToJD (2000, 5, 17, true) + (0+0/60)/24, 50.8796, 4.7009, 0],
            expectedOutput : 
            [/*5, // month
            17,  // day */
            14 + (41+11.8/60)/60, // RA
            -(11+((23+36/60)/60)), // DEC
            //!! todo: insert here magnitude
            // 2.3,
            30.16 / 60, // semidiameter in degrees
            62.1009,
            Math.atan2(1, 62.4926) * 180/Math.PI
			/*  11+55/60, // transit time
			2.65815, // delta
			1.64599, // R
            3* Math.PI/180, // elongation
            1, // phase */
            ]
            ,
            actualOutput : [],
            accurracy : [/*0, 0,*/ 6e-4, 3e-3, 
                5e-3,
                2e-3,
                7e-3,
                /*2e-2,
				7e-6,
				5e-5,
				1e-3,
				1e-3,
				//5e-3, 
				 //5e-2, 
				// 1e-1, 
				// 1e-3, */
				],
            test : function () {
            var data =  AAJS['Moon']['PositionalEphemeris'] (this.input[0],this.input[1],this.input[2], this.input[3]);
                this.actualOutput = [data.RA, data.Dec, data.diameter, data.R, data.parallax];

                if (this.expectedOutput.length != this.actualOutput.length ||
                    this.expectedOutput.length != this.accurracy.length)
                    return false;
                
                var i = 0;
                for (i = 0; i < this.expectedOutput.length; i++) {
                    if (!testlib.doubleEq(this.actualOutput[i] , this.expectedOutput[i], this.accurracy[i]))
                        return false;
                }
                
                return true;
            }
        },

        {
            name : "Topocentric Moon Data for 2017-05-17 00:00 UTC, lat. 50.8796, long. 4.7009, alt. 0",
            input : [AAJS.Date.DateToJD (2017, 5, 17, true) + (0+0/60)/24, 50.8796, 4.7009, 0],
            expectedOutput : 
            [/*5, // month
            17,  // day */
            20 + (21+46/60)/60, // RA
            -(18+((4+41/60)/60)), // DEC
            //!! todo: insert here magnitude
            // 2.3,
            29.97 / 60, // semidiameter in degrees
            62.4926,
            Math.atan2(1, 62.4926) * 180/Math.PI
			/*  11+55/60, // transit time
			2.65815, // delta
			1.64599, // R
            3* Math.PI/180, // elongation
            1, // phase */
            ]
            ,
            actualOutput : [],
            accurracy : [/*0, 0,*/ 7e-4, 2e-3, 
                1e-4,
                7e-3,
                3e-5,
                /*2e-2,
				7e-6,
				5e-5,
				1e-3,
				1e-3,
				//5e-3, 
				 //5e-2, 
				// 1e-1, 
				// 1e-3, */
				],
            test : function () {
            var data =  AAJS['Moon']['PositionalEphemeris'] (this.input[0],this.input[1],this.input[2], this.input[3]);
                this.actualOutput = [data.RA, data.Dec, data.diameter, data.R, data.parallax];

                if (this.expectedOutput.length != this.actualOutput.length ||
                    this.expectedOutput.length != this.accurracy.length)
                    return false;
                
                var i = 0;
                for (i = 0; i < this.expectedOutput.length; i++) {
                    if (!testlib.doubleEq(this.actualOutput[i] , this.expectedOutput[i], this.accurracy[i]))
                        return false;
                }
                
                return true;
            }
        },
        
        {
            name : "Geocentric Moon Data for 1992-04-12 00:00 UTC, lat. 0, long. 0, alt. 0",
            input : AAJS.Date.DateToJD (1992, 4, 12, true),
            expectedOutput :  [ 8 + (58+45.1/60)/60,  (13+((46+6/60)/60)) ],
            actualOutput : [],
            accurracy : [4e-5, 4e-5],
            test : function () {
            var data =  AAJS['Moon']['GeocentricEquatorialPosition'] (this.input);
                this.actualOutput = [data.X, data.Y];

                if (this.expectedOutput.length != this.actualOutput.length ||
                    this.expectedOutput.length != this.accurracy.length)
                    return false;
                
                var i = 0;
                for (i = 0; i < this.expectedOutput.length; i++) {
                    if (!testlib.doubleEq(this.actualOutput[i] , this.expectedOutput[i], this.accurracy[i]))
                        return false;
                }
                
                return true;
            }
        }

        ];
            
        testlib.runTests (tests);
            
    })();
            
        </script>

